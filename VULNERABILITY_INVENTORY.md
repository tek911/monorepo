# VulnMonolith - Vulnerability Inventory

This document catalogs all intentionally seeded vulnerabilities for security scanner testing.

## Summary Statistics

| Category | Count | Critical | High | Medium | Low |
|----------|-------|----------|------|--------|-----|
| SQL Injection | 25+ | 15 | 10 | - | - |
| XSS | 15+ | 5 | 8 | 2 | - |
| Command Injection | 12+ | 12 | - | - | - |
| SSRF | 10+ | 5 | 5 | - | - |
| Insecure Deserialization | 8+ | 8 | - | - | - |
| Path Traversal | 10+ | 5 | 5 | - | - |
| Hardcoded Secrets | 50+ | 20 | 20 | 10 | - |
| Weak Cryptography | 15+ | 5 | 10 | - | - |
| IaC Misconfigurations | 30+ | 10 | 15 | 5 | - |
| Vulnerable Dependencies | 20+ | 8 | 10 | 2 | - |

---

## Services

### auth-service (Java Spring Boot)

| Vulnerability | File | Line | CWE | Severity |
|--------------|------|------|-----|----------|
| SQL Injection | LoginController.java | 67 | CWE-89 | Critical |
| SQL Injection | UserController.java | 45 | CWE-89 | Critical |
| SQL Injection | UserRepository.java | 45 | CWE-89 | Critical |
| XXE | XmlController.java | 23 | CWE-611 | High |
| Insecure Deserialization | ObjectEndpointController.java | 34 | CWE-502 | Critical |
| Weak Password Hashing (MD5) | PasswordUtils.java | 12 | CWE-328 | High |
| Hardcoded JWT Secret | JwtConfig.java | 8 | CWE-798 | Critical |
| IDOR | UserController.java | 89 | CWE-639 | Medium |
| Insecure Random | TokenGenerator.java | 15 | CWE-330 | Medium |
| Log4Shell (CVE-2021-44228) | pom.xml (log4j 2.14.1) | - | CWE-917 | Critical |

### api-gateway (Node.js/TypeScript)

| Vulnerability | File | Line | CWE | Severity |
|--------------|------|------|-----|----------|
| Prototype Pollution | utils/merge.ts | 34 | CWE-1321 | Critical |
| Command Injection | handlers/file.ts | 56 | CWE-78 | Critical |
| SSRF | handlers/preview.ts | 23 | CWE-918 | High |
| Path Traversal | middleware/static.ts | 45 | CWE-22 | High |
| ReDoS | validators/email.ts | 12 | CWE-1333 | Medium |
| Timing Attack | middleware/auth.ts | 8 | CWE-208 | Medium |
| SSTI | handlers/template.ts | 30 | CWE-94 | Critical |
| Vulnerable lodash (CVE-2020-8203) | package.json | - | - | High |

### billing-service (Python FastAPI)

| Vulnerability | File | Line | CWE | Severity |
|--------------|------|------|-----|----------|
| SQL Injection | routers/invoices.py | 34 | CWE-89 | Critical |
| Pickle Deserialization RCE | routers/payments.py | 23 | CWE-502 | Critical |
| Unsafe YAML Loading | routers/payments.py | 45 | CWE-502 | Critical |
| SSTI | routers/reports.py | 30 | CWE-94 | High |
| Path Traversal | routers/reports.py | 67 | CWE-22 | High |
| Hardcoded Stripe Keys | config/settings.py | 12 | CWE-798 | Critical |
| SSRF | routers/webhooks.py | 20 | CWE-918 | High |
| Vulnerable PyYAML (CVE-2020-1747) | requirements.txt | - | - | Critical |

### legacy-monolith (PHP)

| Vulnerability | File | Line | CWE | Severity |
|--------------|------|------|-----|----------|
| SQL Injection | login.php | 23 | CWE-89 | Critical |
| SQL Injection | search.php | 45 | CWE-89 | Critical |
| Remote Code Execution (eval) | admin/eval.php | 12 | CWE-94 | Critical |
| Local File Inclusion | includes/router.php | 34 | CWE-98 | Critical |
| Reflected XSS | search.php | 56 | CWE-79 | High |
| Stored XSS | users.php | 78 | CWE-79 | High |
| Command Injection | admin/eval.php | 50 | CWE-78 | Critical |
| Unrestricted File Upload | upload.php | 34 | CWE-434 | High |
| Weak Crypto (MD5) | auth/password.php | 12 | CWE-328 | High |
| Session Fixation | login.php | 45 | CWE-384 | Medium |
| CSRF (missing tokens) | all forms | - | CWE-352 | Medium |

### realtime-service (Go + Rust)

| Vulnerability | File | Line | CWE | Severity |
|--------------|------|------|-----|----------|
| SQL Injection | handlers/query.go | 45 | CWE-89 | Critical |
| Command Injection | handlers/exec.go | 23 | CWE-78 | Critical |
| Path Traversal | handlers/file.go | 56 | CWE-22 | High |
| SSRF | handlers/fetch.go | 34 | CWE-918 | High |
| Insecure TLS | config/tls.go | 12 | CWE-295 | High |
| Race Condition | cache/memory.go | 78 | CWE-362 | Medium |
| Weak Crypto | crypto/hash.go | 23 | CWE-328 | Medium |
| Buffer Overflow (Rust) | rust-ffi/src/lib.rs | 34 | CWE-120 | Critical |
| Use After Free (Rust) | rust-ffi/src/lib.rs | 56 | CWE-416 | Critical |

---

## Infrastructure as Code

### Terraform (aws-legacy)

| Misconfiguration | File | Resource | Severity |
|-----------------|------|----------|----------|
| Hardcoded AWS Credentials | main.tf | provider | Critical |
| Public S3 Bucket | main.tf | aws_s3_bucket.data | High |
| Security Group 0.0.0.0/0 | main.tf | aws_security_group.app | High |
| Publicly Accessible RDS | main.tf | aws_db_instance.database | Critical |
| Unencrypted RDS | main.tf | aws_db_instance.database | High |
| IAM * Permissions | main.tf | aws_iam_role_policy | Critical |
| No State Locking | main.tf | - | Medium |

### Terraform (aws-modern)

| Misconfiguration | File | Resource | Severity |
|-----------------|------|----------|----------|
| Lambda Admin Access | main.tf | aws_iam_role_policy_attachment | Critical |
| Secrets in Lambda Env | main.tf | aws_lambda_function | Critical |
| Public EKS Endpoint | main.tf | aws_eks_cluster | High |
| No VPC Flow Logs | main.tf | aws_vpc | Medium |
| S3 Public Access | main.tf | aws_s3_bucket_public_access_block | High |

### Kubernetes

| Misconfiguration | File | Resource | Severity |
|-----------------|------|----------|----------|
| Privileged Container | deployment.yaml | Deployment | Critical |
| hostPath Mount (/) | deployment.yaml | Deployment | Critical |
| Docker Socket Mount | deployment.yaml | Deployment | Critical |
| No Resource Limits | deployment.yaml | Deployment | Medium |
| cluster-admin Binding | deployment.yaml | ClusterRoleBinding | Critical |
| Secrets in ConfigMap | deployment.yaml | ConfigMap | High |
| No Network Policy | network-policy.yaml | NetworkPolicy | Medium |

### CloudFormation

| Misconfiguration | File | Resource | Severity |
|-----------------|------|----------|----------|
| Public S3 Bucket | main.yaml | DataBucket | High |
| Open Security Group | main.yaml | AppSecurityGroup | High |
| Public RDS | main.yaml | Database | Critical |
| Hardcoded Credentials | main.yaml | Parameters | Critical |
| Secrets in UserData | main.yaml | AppInstance | Critical |

---

## Vulnerable Dependencies (SCA)

### Java (auth-service)

| Package | Version | CVE | Severity |
|---------|---------|-----|----------|
| log4j-core | 2.14.1 | CVE-2021-44228 | Critical |
| spring-boot | 2.5.0 | CVE-2022-22965 | Critical |
| jackson-databind | 2.9.8 | CVE-2019-12086 | High |
| snakeyaml | 1.26 | CVE-2022-25857 | High |
| commons-collections | 3.2.1 | Multiple | High |

### Node.js (api-gateway)

| Package | Version | CVE | Severity |
|---------|---------|-----|----------|
| lodash | 4.17.15 | CVE-2020-8203 | High |
| axios | 0.21.0 | CVE-2021-3749 | High |
| express | 4.16.0 | CVE-2019-15138 | Medium |
| minimist | 1.2.0 | CVE-2020-7598 | High |
| handlebars | 4.5.0 | Multiple | High |

### Python (billing-service)

| Package | Version | CVE | Severity |
|---------|---------|-----|----------|
| PyYAML | 5.3 | CVE-2020-1747 | Critical |
| Pillow | 8.0.0 | CVE-2021-25287+ | High |
| requests | 2.20.0 | CVE-2018-18074 | Medium |
| Jinja2 | 2.10 | CVE-2019-10906 | Medium |

### Go (realtime-service)

| Package | Version | CVE | Severity |
|---------|---------|-----|----------|
| jwt-go | 3.2.0 | CVE-2020-26160 | High |
| x/crypto | old | Multiple | High |

### Rust (rust-ffi)

| Package | Version | CVE | Severity |
|---------|---------|-----|----------|
| smallvec | 0.6.0 | CVE-2019-15551 | Critical |
| crossbeam | 0.7.0 | CVE-2020-35863 | High |

---

## Hardcoded Secrets

### Location Summary

| Type | Count | Locations |
|------|-------|-----------|
| AWS Credentials | 10+ | .env files, config files, IaC |
| Database Passwords | 15+ | config files, connection strings |
| API Keys (Stripe, SendGrid, etc.) | 12+ | config files, .env, source code |
| JWT Secrets | 8+ | config files, source code |
| SSH/Private Keys | 3+ | Ansible playbooks, config |

### Sample Locations

- `services/auth-service/src/main/resources/application.properties`
- `services/auth-service/.env`
- `services/api-gateway/src/config/index.ts`
- `services/api-gateway/.env`
- `services/billing-service/config/settings.py`
- `services/billing-service/.env`
- `services/legacy-monolith/config.php`
- `services/realtime-service/config/config.go`
- `infrastructure/terraform/*/main.tf`
- `infrastructure/ansible/playbook.yml`
- `infrastructure/cloudformation/main.yaml`

---

## Scanner Testing Notes

### Expected True Positives
- All SQL injection instances should be detected
- All command injection instances should be detected
- Hardcoded secrets should trigger secret detection
- Vulnerable dependencies should be flagged by SCA tools
- IaC misconfigurations should be caught by IaC scanners

### Expected Challenges
- Files in `test-fixtures/` should be excluded
- Generated code in `shared-libs/generated/` may cause false positives
- Vendored code in `vendor/` should be detected without manifest reference
- Parser stress tests may cause scanner failures
- Deep nesting and unusual encodings may cause issues

### Exclusion Testing
Scanners should respect exclusions for:
- `**/test-fixtures/**`
- `**/node_modules/**`
- `**/*.test.*`
- `**/__tests__/**`

---

## Contributing

When adding new vulnerabilities:
1. Update this inventory with location and details
2. Add appropriate CWE reference
3. Assign severity rating
4. Document expected scanner behavior
