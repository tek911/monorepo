# CodeQL configuration
# Test: Verify CodeQL respects custom configurations

name: "VulnMonolith CodeQL Config"

# ISSUE: Not using security-extended or security-and-quality
queries:
  - uses: security-extended
  # Missing: security-and-quality for comprehensive coverage

paths:
  - services
  - shared-libs

# ISSUE: Broad path exclusions
paths-ignore:
  - test-fixtures
  - orphaned
  - '**/vendor/**'
  - '**/node_modules/**'
  - '**/*_test.go'
  - '**/*.test.js'
  - '**/*.spec.ts'
  - '**/docs/**'
  - '**/generated/**'
  # ISSUE: Excluding entire services
  - services/legacy-monolith
  - services/realtime-service/rust-ffi

# Query filters - ISSUE: Suppressing important findings
query-filters:
  # Exclude medium severity
  - exclude:
      severity: medium
  # Exclude specific CWEs
  - exclude:
      tags contain: external/cwe/cwe-079  # XSS
  - exclude:
      tags contain: external/cwe/cwe-089  # SQL Injection
  - exclude:
      tags contain: external/cwe/cwe-078  # Command Injection

# ISSUE: Trap caching can hide new vulnerabilities
trap-caching: true
